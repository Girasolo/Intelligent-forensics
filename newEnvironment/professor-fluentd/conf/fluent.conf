<source>
  @type forward
  port 24224
  bind 0.0.0.0
</source>


#Syslogs of all the nodes. Collects all the syslog send at the port 5140 from all the possible addr (bing 0.0.0.0)
#protocol type is set to tcp (instead of the default udp)
<source>
  @type syslog
  port 5140
  tag syslog
  bind 0.0.0.0
  protocol_type tcp
</source>


<match dos.tracer.logs>
  @type copy
  <store>
    @type exec
    command python3 /shared-volume/prediction/1prediction.py
    <format>
      @type json
    </format>
  </store>
  <store>
    @type file
    path fluentd/output/DoS/dos.log
    append true
    <buffer>
      @type file
      path /var/lib/fluentd/dos_logs_buffer # Specify the path to your buffer directory.
      flush_mode immediate  # Flush the buffer immediately when Fluentd starts.
      retry_max_times 5  # Maximum number of retry attempts.
    </buffer>
  </store>
</match>

#All the sources are matched. 
#append allows to continue writing the file even if it's already writtedn.
#buffer section assure the empty of the buffer when the service starts.
<match **>
  @type file
  path /fluentd/output/output.log
  append true
  <buffer>
    @type file
    path /var/lib/fluentd/buffer  # Specify the path to your buffer directory.
    flush_mode immediate  # Flush the buffer immediately when Fluentd starts.
    retry_max_times 5  # Maximum number of retry attempts.
  </buffer>
</match>

  

